# 遍历数组

数组遍历方式众多，但在业务场景中，应该根据需求的不同，使用切当的遍历方式。在数组数据量不大的情况下，避免滥用 for 循环。

## for 循环

```js
const arr = [1, 2, 3, 4, 5];
for (let i = 0; i < arr.length; i++) {
  console.log("for", arr[i]); // 1, 2, 3, 4, 5
}
for (let i = 0, len = arr.length; i < len; i++) {
  // 优化版
}
```

:::tip 案例解析
最常用的数组遍历方式，性能最佳，但代码编写方式繁琐，获取数组元素需要索引`arr[i]`。根据业务场景来说，适合需要索引来操作后续业务的场景，以及数组数据量非常大的场景。使用优化版，将数组长度缓存到变量 `len` 中，可以保证每次循环都要获取数组长度的性能影响。
:::

## forEach()

```js
const arr = [1, 2, 3, 4, 5];
arr.forEach(item => {
  console.log("forEach", item); // 1, 2, 3, 4, 5
});
arr.forEach((item, index) => {
  console.log("forEach", index, item); // 遍历索引
});
```

:::tip 案例解析
使用频率仅次于 `for` 循环的数组遍历方式，性能不如 `for` 循环。适合无需遍历数组索引的场景，可以直接获取遍历出来的数组项，操作简单。如果需要遍历索引，传入 `index` 参数即可。在数据量不是非常大的情况下，如果需要遍历出数组中的对象直接进行属性操作等，推荐使用 `forEach()`方法。
:::

## for...of...

```js
const arr = [1, 2, 3, 4, 5];
for (let item of arr) {
  console.log("for...of...", item); // 1, 2, 3, 4, 5
}
```

:::tip 案例解析
`for...of...`循环是 ES6 提供的方法，可以遍历出数组的元素。`for...of...`依赖于数据结构的 `Symbol.iterator` 属性，关于更多 `for...of...`的底层实现，在成书出版时会进行补充。
:::

## for...in...

```js
const arr = [1, 2, 3, 4, 5];
for (let index in arr) {
  console.log("for...in...", index); // 0,1, 2, 3, 4
}
```

:::tip 案例解析
通过观察可以发现，`for...in...`循环遍历出的是数组的索引，类似于`for`循环。`for...of...`循环遍历出的是数组的元素。获取数组元素需要使用`arr[index]`，效率也是最差的，所以`for...in...`循环对于数组遍历不是最常用的方法，这点不像在对象中那么重要，完全可用`for`循环代替，了解即可。
:::

## map()

```js
const arr = [1, 2, 3, 4, 5];
arr.map(item => {
  console.log("map", item); // 1, 2, 3, 4, 5
});
```

:::tip 案例解析
从形式上看，使用数组 `map()`等数组过滤的方法均可以实现数组的遍历(本质上，这些方法的底层机制也是遍历)。但是，根据我自己的业务场景理解，这类方法更适合用来进行数组的过滤，可以在循环体中直接 `return` 一个过滤条件。对于遍历，`map()` 的效率也不如 `forEach()`方法。对比 `forEach()`方法，`forEach()`循环体内是不可以 `return` 过滤条件的（可以试一下哦），这就是他们的一个重要的区别。具体的数组过滤操作，请前往应用场景-数组过滤一章。
:::

## 遍历方法对比

1. for 循环和 for-in 能正确响应 break、continue 和 return 语句，但 forEach 不行。
2. for-in 循环是为了遍历对象而设计的，事实上 for-in 也能用来遍历数组，但定义的索引 i 是字符串类型的。如果数组具有一个可枚举的方法，也会被 for-in 遍历到
3. for-of 遍历方法用来遍历各种类数组集合，例如 DOM NodeList 对象、Map 和 Set 对象，甚至字符串也行。

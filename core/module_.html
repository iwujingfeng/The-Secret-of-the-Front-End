<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>模块 | 前端核心技术与应用场景揭秘</title>
    <meta name="description" content="从实际应用场景出发，彻底掌握核心技术">
    <link rel="icon" href="/The-Secret-of-the-Front-End/logo.png">
  <link rel="manifest" href="/The-Secret-of-the-Front-End/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/The-Secret-of-the-Front-End/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/The-Secret-of-the-Front-End/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/The-Secret-of-the-Front-End/assets/css/0.styles.c71dac19.css" as="style"><link rel="preload" href="/The-Secret-of-the-Front-End/assets/js/app.d61db1a3.js" as="script"><link rel="preload" href="/The-Secret-of-the-Front-End/assets/js/28.5c28df11.js" as="script"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/17.edd76cd2.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/1.d12300eb.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/2.396f006c.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/3.bfb9f7b8.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/4.93769201.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/5.16586269.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/6.9b588305.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/7.59216026.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/8.b421ad78.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/9.e4a1e545.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/10.e0b122c8.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/11.e78c9ad2.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/12.23ab4971.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/13.a92485af.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/14.df5bb8f9.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/15.39f7f39a.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/16.7ddf6876.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/18.eeb1a7b6.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/19.09a7dd16.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/20.e9d7ad50.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/21.6427ee9a.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/22.067d5c78.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/23.0a9ef729.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/24.dad5827a.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/25.830618d8.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/26.e69e851d.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/27.cf9440e0.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/29.9a166935.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/30.14740bf5.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/31.2c582c6f.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/32.54b7a172.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/33.f019adad.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/34.edde84ce.js"><link rel="prefetch" href="/The-Secret-of-the-Front-End/assets/js/35.13d58945.js">
    <link rel="stylesheet" href="/The-Secret-of-the-Front-End/assets/css/0.styles.c71dac19.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/The-Secret-of-the-Front-End/" class="home-link router-link-active"><!----> <span class="site-name">前端核心技术与应用场景揭秘</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/The-Secret-of-the-Front-End/core/" class="nav-link router-link-active">核心技术</a></div><div class="nav-item"><a href="/The-Secret-of-the-Front-End/scene/" class="nav-link">应用场景</a></div><div class="nav-item"><a href="/The-Secret-of-the-Front-End/question/" class="nav-link">经典问答</a></div> <a href="https://github.com/iwujingfeng/The-Secret-of-the-Front-End" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/The-Secret-of-the-Front-End/core/" class="nav-link router-link-active">核心技术</a></div><div class="nav-item"><a href="/The-Secret-of-the-Front-End/scene/" class="nav-link">应用场景</a></div><div class="nav-item"><a href="/The-Secret-of-the-Front-End/question/" class="nav-link">经典问答</a></div> <a href="https://github.com/iwujingfeng/The-Secret-of-the-Front-End" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>核心技术</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/The-Secret-of-the-Front-End/core/prototype.html" class="sidebar-link">原型 原型链 继承</a></li><li><a href="/The-Secret-of-the-Front-End/core/new.html" class="sidebar-link">new 运算符</a></li><li><a href="/The-Secret-of-the-Front-End/core/object.html" class="sidebar-link">Object 构造函数</a></li><li><a href="/The-Secret-of-the-Front-End/core/recursion.html" class="sidebar-link">递归</a></li><li><a href="/The-Secret-of-the-Front-End/core/circular.html" class="sidebar-link">循环引用</a></li><li><a href="/The-Secret-of-the-Front-End/core/memory-leak.html" class="sidebar-link">内存泄漏</a></li><li><a href="/The-Secret-of-the-Front-End/core/module_.html" class="active sidebar-link">模块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#历史" class="sidebar-link">历史</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#script-标签" class="sidebar-link">&lt;script&gt; 标签</a></li><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#commonjs" class="sidebar-link">CommonJS</a></li><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#amd" class="sidebar-link">AMD</a></li><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#cmd" class="sidebar-link">CMD</a></li><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#es-module" class="sidebar-link">ES Module</a></li></ul></li><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#对比" class="sidebar-link">对比</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#es-module-与-commonjs-模块的差异" class="sidebar-link">ES Module 与 CommonJS 模块的差异</a></li><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#amd（requirejs）与-commonjs（node-js）对比" class="sidebar-link">AMD（RequireJS）与 CommonJS（Node.js）对比</a></li><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#amd（requirejs）与-cmd（sea-js）对比" class="sidebar-link">AMD（RequireJS）与 CMD（Sea.js）对比</a></li><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#es-module-与-amd-模块、cmd模块的差异" class="sidebar-link">ES Module 与 AMD 模块、CMD模块的差异</a></li></ul></li><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#循环引用" class="sidebar-link">循环引用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#commonjs-2" class="sidebar-link">CommonJS</a></li><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#es-module-2" class="sidebar-link">ES Module</a></li><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#amd-模块" class="sidebar-link">AMD 模块</a></li><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#cmd模块" class="sidebar-link">CMD模块</a></li></ul></li><li class="sidebar-sub-header"><a href="/The-Secret-of-the-Front-End/core/module_.html#静态分析" class="sidebar-link">静态分析</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="模块"><a href="#模块" aria-hidden="true" class="header-anchor">#</a> 模块</h1> <h2 id="历史"><a href="#历史" aria-hidden="true" class="header-anchor">#</a> 历史</h2> <p>最早的模块化尝试，可以认为是使用 <code>&lt;script&gt;</code> 标签引入不同的js文件，</p> <h3 id="script-标签"><a href="#script-标签" aria-hidden="true" class="header-anchor">#</a> <code>&lt;script&gt;</code> 标签</h3> <h4 id="一、直接在js文件中定义变量、方法等"><a href="#一、直接在js文件中定义变量、方法等" aria-hidden="true" class="header-anchor">#</a> 一、直接在js文件中定义变量、方法等</h4> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>module_1.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>module_2.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module_1.js</span>
<span class="token keyword">var</span> moduleOne <span class="token operator">=</span> <span class="token string">'这是模块一的内容'</span>

<span class="token comment">// module_2.js</span>
<span class="token keyword">var</span> moduleTwo <span class="token operator">=</span> <span class="token string">'这是模块二的内容'</span>
<span class="token keyword">var</span> moduleOne <span class="token operator">=</span> <span class="token string">'模块二使用和模块一同名的变量，覆盖了模块一的内容'</span> <span class="token comment">// 变量重名</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">案例解析</p> <p>在使用<code>&lt;script&gt;</code>引入不同 js 文件后，页面中输入两个 js 文件中的变量，发现 <code>module_1.js</code> 中定义的 <code>moduleOne</code> 并没有正确输入，而是输出了 <code>module_2.js</code> 中定义的 <code>moduleOne</code> 的内容。所以该方法非常薄弱，最大的缺点就是各个 js 文件中的定义的 <code>变量</code> 都被绑定在了 <code>全局的 window / Global(node 环境下的全局变量) 对象</code>上，只有其他 js 文件中有和另一个 js 文件 <code>命名相同</code> 的变量，值就会被覆盖。</p></div> <h4 id="二、函数模式：在不同的js文件定义全局函数"><a href="#二、函数模式：在不同的js文件定义全局函数" aria-hidden="true" class="header-anchor">#</a> 二、函数模式：在不同的js文件定义全局函数</h4> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>module_1.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>module_2.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
            <span class="token comment">// 模块内容用函数包裹后</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'模块一 函数：'</span><span class="token punctuation">,</span> <span class="token function">moduleOneWrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>newModuleOne<span class="token punctuation">)</span> <span class="token comment">// 用函数包裹的模块一的内容</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'模块二 函数：'</span><span class="token punctuation">,</span> <span class="token function">moduleTwoWrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>newModuleTwo<span class="token punctuation">)</span> <span class="token comment">// 用函数包裹的模块二的内容</span>
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module_1.js</span>
<span class="token comment">// 使用函数</span>
<span class="token keyword">function</span> <span class="token function">moduleOneWrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> newModuleOne <span class="token operator">=</span> <span class="token string">'用函数包裹的模块一的内容'</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        newModuleOne<span class="token punctuation">:</span> newModuleOne
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// module_2.js</span>
<span class="token comment">// 使用函数</span>
<span class="token keyword">function</span> <span class="token function">moduleTwoWrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> newModuleTwo <span class="token operator">=</span> <span class="token string">'用函数包裹的模块二的内容'</span>
    <span class="token keyword">var</span> newModuleOne <span class="token operator">=</span> <span class="token string">'用函数包裹后，覆盖模块一的内容'</span> <span class="token comment">// 变量重名</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        newModuleOne<span class="token punctuation">:</span> newModuleOne<span class="token punctuation">,</span>
        newModuleTwo<span class="token punctuation">:</span> newModuleTwo<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">案例解析</p> <p>这次在 js 文件内部使用一个<code>函数</code>，将所有的变量、方法等进行包裹，因为函数拥有自己的<code>作用域</code>，所以函数内部的变量，并不会影响其他js文件中函数包裹的<code>同名变量</code>的值。但该方法中的定义的函数依然被绑定在<code>window</code>全局对象上，并不能解决变量污染问题，如果出现<code>同名函数</code>，依然污染全局命名空间，容易引起命名冲突或数据不安全，而且模块成员之间看不出直接关系。</p></div> <h4 id="三、对象模式：在不同的js文件定义一个对象"><a href="#三、对象模式：在不同的js文件定义一个对象" aria-hidden="true" class="header-anchor">#</a> 三、对象模式：在不同的js文件定义一个对象</h4> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>module_1.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>module_2.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
            <span class="token comment">// 使用对象</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'模块二 对象：'</span><span class="token punctuation">,</span> moduleOneObj<span class="token punctuation">.</span>newModuleOne<span class="token punctuation">)</span> <span class="token comment">// 用作为对象属性的模块一的内容</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'模块二 对象：'</span><span class="token punctuation">,</span> moduleTwoObj<span class="token punctuation">.</span>newModuleTwo<span class="token punctuation">)</span> <span class="token comment">// 作为对象属性的模块二的内容</span>
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module_1.js</span>
<span class="token comment">// 使用对象</span>
<span class="token keyword">var</span> moduleOneObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
moduleOneObj<span class="token punctuation">.</span>newModuleOne <span class="token operator">=</span> <span class="token string">'作为对象属性的模块一的内容'</span>

<span class="token comment">// module_2.js</span>
<span class="token comment">// 使用对象</span>
<span class="token keyword">var</span> moduleTwoObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
moduleTwoObj<span class="token punctuation">.</span>newModuleTwo <span class="token operator">=</span> <span class="token string">'作为对象属性的模块二的内容'</span>
moduleTwoObj<span class="token punctuation">.</span>newModuleOne <span class="token operator">=</span> <span class="token string">'作为对象属性的覆盖模块一的内容'</span> <span class="token comment">// 变量重名</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">案例解析</p> <p>在js文件内容定义了一个<code>对象</code>，分别为对象添加<code>属性</code>和<code>方法</code>，因为对象也有自己的<code>作用域</code>，所以其他js文件中的变量并不会受到污染。但和使用函数一样，对象本身也被绑定在了<code>window</code>全局对象中，如果对象本发生了同名，也会导致变量污染。第三种方法是使用了立即执行函数，这也是第三方库常用的方式。这样的写法会暴露所有模块成员，内部状态可以被外部改写。</p></div> <h4 id="四、立即执行函数：在不同的js文件定义一个对象"><a href="#四、立即执行函数：在不同的js文件定义一个对象" aria-hidden="true" class="header-anchor">#</a> 四、立即执行函数：在不同的js文件定义一个对象</h4> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>jquery-1.10.1.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>module_1.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>module_2.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
            <span class="token comment">// 立即执行函数</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'模块一 立即执行函数：'</span><span class="token punctuation">,</span> moduleOne<span class="token punctuation">.</span>newModuleOne<span class="token punctuation">)</span> <span class="token comment">// 立即执行函数包裹的模块一的内容</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'模块二 立即执行函数：'</span><span class="token punctuation">,</span> moduleTwo<span class="token punctuation">.</span>newModuleTwo<span class="token punctuation">)</span> <span class="token comment">// 立即执行函数包裹的模块二的内容</span>
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module_1.js</span>
<span class="token comment">// 立即执行函数</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>window<span class="token punctuation">,</span>$<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> newModuleOne <span class="token operator">=</span> <span class="token string">'立即执行函数包裹的模块一的内容'</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'background'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span>moduleOne <span class="token operator">=</span> <span class="token punctuation">{</span>
        newModuleOne<span class="token punctuation">:</span> newModuleOne
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span>jQuery<span class="token punctuation">)</span>

<span class="token comment">// module_2.js</span>
<span class="token comment">// 立即执行函数</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> newModuleTwo <span class="token operator">=</span> <span class="token string">'立即执行函数包裹的模块二的内容'</span>
    <span class="token keyword">var</span> newModuleOne <span class="token operator">=</span> <span class="token string">'用函数包裹后的覆盖模块一的内容'</span> <span class="token comment">// 变量重名</span>

    window<span class="token punctuation">.</span>moduleTwo <span class="token operator">=</span> <span class="token punctuation">{</span>
        newModuleOne<span class="token punctuation">:</span> newModuleOne<span class="token punctuation">,</span>
        newModuleTwo<span class="token punctuation">:</span> newModuleTwo<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">案例解析</p> <p>立即执行函数，这也是第三方库常用的方式。 数据是私有的，外部只能通过暴露的方法操作；将数据和行为封装到一个函数内部, 通过给 window 添加属性来向外暴露接口；如果模块需要依赖第三方库，可以将第三方库以参数的方法传递给立即执行函数，但是，在<code>&lt;script&gt;</code>引入js文件时，必须先引入依赖的第三方库。</p></div> <h3 id="commonjs"><a href="#commonjs" aria-hidden="true" class="header-anchor">#</a> CommonJS</h3> <p>CommonJS 是一套通用的规范，与之对应的有非常多不同的实现，Node.js 实现的 CommonJS 是最为关注的部分，详细内容可以阅读node官方文档 module（模块）部分。Node 应用应用中，每个文件就是一个模块，有自己的作用域。在一个文件里面定义的变量、函数、类，都是私有的，对其他文件不可见。</p> <p>每个模块内部,都有一个module对象，module对象代表当前模块，它的exports属性（即module.exports）是对外的接口。加载某个模块，其实是加载该模块的module.exports属性，也就是手，当使用require引入一个模块时，引入的就是exports对应的值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module_A.js</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">10</span>
module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>a <span class="token operator">=</span> a <span class="token comment">// 导出模块方式一</span>

<span class="token comment">// module_B.js</span>
<span class="token keyword">const</span> moduleA <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./module_A.js'</span><span class="token punctuation">)</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 导出模块方式二</span>
    <span class="token keyword">return</span> moduleA<span class="token punctuation">.</span>a <span class="token operator">*</span> <span class="token number">10</span>
<span class="token punctuation">}</span>

<span class="token comment">// module_C.js</span>
<span class="token keyword">const</span> moduleB <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./module_B.js'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">// 导出模块方式三</span>
    c<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> moduleB<span class="token punctuation">.</span>foo <span class="token operator">+</span> <span class="token number">50</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// main.js</span>
<span class="token keyword">const</span> moduleC <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./module_C.js'</span><span class="token punctuation">)</span> <span class="token comment">// 导出模块方式一</span>
<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./module_B.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>foo <span class="token comment">// 导出模块方式二</span>
moduleC<span class="token punctuation">.</span><span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 150</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 100</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">案例解析</p> <p>对于CommonJS规范，所有代码都运行在模块作用域，不会污染全局作用域。模块可以多次加载，但是只会在第一次加载时运行一次，然后运行结果就被缓存了，以后再加载，就直接读取缓存结果。要想让模块再次运行，必须清除缓存，譬如执行delete require.cache[moduleName]。模块加载的顺序，按照其在代码中出现的顺序执行。require导入一个模块时，做了这样一件事情，把被引用的 module 拷贝了一份到当前 module 中。module.exports 属性表示当前模块对外输出的接口，其他文件加载该模块，实际上就是读取该模块的module.exports变量。Node 为每个模块提供一个exports变量，exports 是 module.exports 的引用，相当于隐式的在模块文件的顶部将module.exports赋值给了变量 exports。对外输出模块接口时，可以向exports对象添加方法暴露出去，譬如exports.a = 1。作为一个引用，如果我们修改它的值，实际上修改的是它对应的引用对象的值，exports.a = 1相当于module.exports = {a: 1}，如果修改 exports 为 exports = {a: 1}，就是把exports指向一个新的对象的引用地址，当然 exports 就不是是 module.exports 的引用了。若依，不能使用exports = {a: 1}这种模块暴露方式。如果改变了module.exports，但还想使用export.xxx的方式暴露一些东西，需要显示的执行exports = module.exports = something。require命令的基本功能是，读入并执行一个JavaScript文件，然后返回该模块的exports对象。如果没有发现指定模块，会报错。如果模块输出的是一个函数，那就不能定义在exports对象上面，而要定义在module.exports变量上面，例如module.exports = function () {}。</p></div> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>如果要在浏览器端使用CommonJS规范，必须借助Browserify等打包工具对模块根据模块依赖关系打包，也就是，以main.js为入口文件，将依赖的模块打包在一块。index.html 的 <code>&lt;script&gt;</code> 标签引入的入口js文件，是打包后的js文件。在浏览器端使用CommonJS规范并不常见，浏览器端使用的模块化方法主要有AMD、CMD 和 ES Module。</p></div> <h3 id="amd"><a href="#amd" aria-hidden="true" class="header-anchor">#</a> AMD</h3> <p>AMD规范主要用于浏览器端。RequireJS 是基于AMD规范实现的工具库，主要用于客户端的模块管理。RequireJS 的基本思想是，通过 define 方法，将代码定义为模块；通过 require 方法，实现代码的模块加载。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
   <span class="token comment">&lt;!-- 在index.html中 引入 require.js 并指定 入口js文件 --&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">data-main</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>js/main.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>js/libs/require.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module_A.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 该模块没有依赖的其他模块</span>
    <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">10</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token comment">// 对外暴露模块</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// module_B.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'module_A'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 该模块依赖 module_A 模块</span>
  <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> module_A<span class="token punctuation">.</span>a <span class="token operator">*</span> <span class="token number">10</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// main.js</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  require<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    baseUrl<span class="token punctuation">:</span> <span class="token string">'js/'</span><span class="token punctuation">,</span> <span class="token comment">// 基本路径</span>
    paths<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 映射: 模块标识名: 路径</span>
      module_A<span class="token punctuation">:</span> <span class="token string">'./module_A'</span><span class="token punctuation">,</span> <span class="token comment">// 此处不能写成 alerter.js, 会报错</span>
      module_B<span class="token punctuation">:</span> <span class="token string">'./module_B'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 入口js文件导入模块</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'module_B'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>module_B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    module_B<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 100</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>可以发现，在浏览器端，AMD 模块相比<code>&lt;script&gt;</code> 标签引入js文件，AMD 模块定义的方法非常清晰，不会污染全局环境，能够清楚地显示依赖关系。AMD 模式可以用于浏览器环境，并且允许非同步加载模块，也可以根据需要动态加载模块。</p></div> <h3 id="cmd"><a href="#cmd" aria-hidden="true" class="header-anchor">#</a> CMD</h3> <p>和AMD规范一样，CMD也主要用于浏览器端。Sea.js 是基于CMD规范实现的工具库。CMD 规范整合了 CommonJS 和 AMD 规范的特点，使用define定义模块，并且使用module.exports 或者 exports 向外暴露模块。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
   <span class="token comment">&lt;!-- 在index.html中 引入 sea.js 并调用 seajs.use 使用入口js文件 --&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>js/libs/sea.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
     seajs<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'./js/main'</span><span class="token punctuation">)</span>
   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module_A.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 该模块没有依赖的其他模块</span>
    <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">10</span>
    exports<span class="token punctuation">.</span>a <span class="token operator">=</span> a <span class="token comment">// 对外暴露模块</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// module_B.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 该模块依赖 module_A 模块</span>
  <span class="token keyword">const</span> moduleA <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./module_A'</span><span class="token punctuation">)</span>
  <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> moduleA<span class="token punctuation">.</span>a <span class="token operator">*</span> <span class="token number">10</span>
  <span class="token punctuation">}</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
      foo<span class="token punctuation">:</span>foo
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// main.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>require<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">var</span> moduleB <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./module_B'</span><span class="token punctuation">)</span>
 moduleB<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 100</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>CMD</p></div> <h3 id="es-module"><a href="#es-module" aria-hidden="true" class="header-anchor">#</a> ES Module</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module_A.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment">// 导出模块方式一</span>

<span class="token comment">// module_B.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./module_A'</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> a <span class="token operator">*</span> <span class="token number">10</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token comment">// 导出模块方式二</span>
    foo<span class="token punctuation">:</span>foo
<span class="token punctuation">}</span>

<span class="token comment">// module_C.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./module_B'</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> foo <span class="token operator">+</span> <span class="token number">50</span>
<span class="token punctuation">}</span> 

<span class="token keyword">export</span> <span class="token keyword">default</span> bar <span class="token comment">// 导出模块方式三</span>

<span class="token comment">// main.js</span>
<span class="token keyword">import</span> bar <span class="token keyword">from</span> <span class="token string">'./module_B'</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 150</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>ES6 模块中，export命令用于规定模块的对外接口，import命令用于输入其他模块提供的功能。如果多次重复执行同一句import语句，那么只会执行一次，而不会执行多次。如下两种均不会多次执行。ES6 模块之中，顶层的 this 指向undefined，不会执行全局，因为ES6 模块默认使用的是严格模式，所以，不应该在顶层代码使用this。export输出的变量就是本来的名字，但是可以使用as关键字重命名，譬如 export { a as b,}。export命令和import命令要处于模块顶层，如果处于块级作用域内，会报错，因为处于条件代码块之中，就没法做静态优化了。</p></div> <h4 id="script-标签内使用-es-module"><a href="#script-标签内使用-es-module" aria-hidden="true" class="header-anchor">#</a> <code>&lt;script&gt;</code> 标签内使用 ES Module</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module_A.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'my-module'</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
  <span class="token keyword">import</span> myModule <span class="token keyword">from</span> <span class="token string">'./myModule.js'</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myModule<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// my-module</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">nomodule</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'你的浏览器不支持ES模块，请先升级！'</span><span class="token punctuation">)</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>在不适用构建工具的情况下，可以在 <code>script</code> 标签上添加一个<code>type=&quot;module&quot;</code>的属性来表示这个文件是以module的方式来运行的。由于ES的模块功能还没有完全支持，在不支持的浏览器下，我们需要一些回退方案，可以通过 <code>nomodule</code> 属性来指定某脚本为回退方案。当浏览器支持type=module时，会忽略带有nomodule的script；如果不支持，则忽略带有type=module的脚本，执行带有<code>nomodule</code>的脚本。在使用type=module引入模块时还有一点需要注意的，module的文件默认为defer，也就是说该文件不会阻塞页面的渲染，会在页面加载完成后按顺序执行。</p></div> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>在使用webpack等打包工具打包时，会对模块根据模块依赖关系打包，也就是，以main.js为入口文件，将依赖的模块打包在一块。index.html 的 <code>&lt;script&gt;</code> 标签引入的入口js文件，是打包后的js文件。</p> <h4 id="node-环境下-使用-es-module"><a href="#node-环境下-使用-es-module" aria-hidden="true" class="header-anchor">#</a> Node 环境下 使用 ES Module</h4> <p>借助 <code>babel-node</code> 执行包含ES模块代码的文件</p></div> <h2 id="对比"><a href="#对比" aria-hidden="true" class="header-anchor">#</a> 对比</h2> <h3 id="es-module-与-commonjs-模块的差异"><a href="#es-module-与-commonjs-模块的差异" aria-hidden="true" class="header-anchor">#</a> ES Module 与 CommonJS 模块的差异</h3> <p>CommonJS 模块输出的是一个值的拷贝，也就是说，一旦输出一个值，模块内部的变化就影响不到这个值。ES6 模块输出的是值的引用，所以，模块内部的改变会影响导入该模块的模块内部的值。ES6 模块的运行机制与 CommonJS 不一样。ES6 模块是动态引用，并且不会缓存值，模块里面的变量绑定其所在的模块。CommonJS 模块是运行时加载，因为 CommonJS 加载的是一个对象（即 module.exports 属性），该对象只有在脚本运行完才会生成。ES6 模块是编译时输出接口，该对外接口只是一种静态定义，在代码静态解析阶段就会生成。CommonJS 这一标准的初衷是为了让 JavaScript 在多个环境下都实现模块化，但是 Node.js 中的实现依赖了 Node.js 的环境变量：module，exports，require，global，浏览器没法用啊，所以后来出现了 Browserify 这样的实现。将被 require 的内容，赋值到一个 module 对象的属性上，然后返回这个对象的 exports 属性。在我们还没有完成复制的时候，无法使用被引用的模块中的方法和属性。在服务端可能这不是一个问题(因为服务器的文件都是存放在本地，并且是有缓存的)，但在浏览器环境下，这会导致阻塞，使得我们后面的步骤无法进行下去，还可能会执行一个未定义的方法而导致出错。相对于服务端的模块化，浏览器环境下，模块化的标准必须满足一个新的需求：异步的模块管理，因为浏览器端要从服务端部署的静态资源中加在模块文件，二资源加载是一种异步加载。ES6 模块在编译时就能确定模块的依赖关系，以及输入和输出的变量，从而可以进行静态优化。ES Module 使用 import命令输入的变量都是只读的，加载后不能修改对导入模块的变量进行修改。如果导入的是一个对象，改写对象的属性是可以的，但因为export输出的值是动态绑定的，如果我们修改了其中的值，就会导致其他地方再次引入该值时会发生变化，此时的默认配置就不是我们所设想的默认配置了。当我们有需求对输入的对象接口进行改变时，可以先对其进行深拷贝出一个新的对象，然后在进行修改，这样就不会导致上述所说的问题了。CommonJS 模块输出的是值的缓存，不存在动态更新。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// CommonJS模块导入</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> a<span class="token punctuation">,</span> b <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./module_A'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ES6模块导入</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> a<span class="token punctuation">,</span> b <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./module_A'</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>上述两种模块导入方式，执行机制并不相同。require执行时，是整体加载了module_A，并且生成了一个对象，然后依次读取该对象的属性a和b。这些都是在运行执行的，因为只有运行时才能得到这个对象，所以无法再编译时做'静态优化'。ES6 模块不是对象，而是通过export命令显式指定输出的代码，再通过import命令输入，只加载import的内容，其他的会忽略，在在编译时就完成了模块加载。</p></div> <h3 id="amd（requirejs）与-commonjs（node-js）对比"><a href="#amd（requirejs）与-commonjs（node-js）对比" aria-hidden="true" class="header-anchor">#</a> AMD（RequireJS）与 CommonJS（Node.js）对比</h3> <p>AMD以函数的形式返回模块的值，尤其是构造函数，可以更好的实现API 设计，Node 中通过 module.exports 来支持这个，但使用 在函数中return模块的值更清晰，因为不必通过处理 module 来实现 module.exports，它是一个更清晰的代码表达式。
CommonJS 依赖于 require 的同步行为，只有加载完成，才能执行后面的操作。这对于 Web 环境来说是不方便的。AMD 通过 require 和函数进行模块的动态加载，允许指定回调函数。。</p> <h3 id="amd（requirejs）与-cmd（sea-js）对比"><a href="#amd（requirejs）与-cmd（sea-js）对比" aria-hidden="true" class="header-anchor">#</a> AMD（RequireJS）与 CMD（Sea.js）对比</h3> <p>AMD声明一个模块时，必须指定所有的依赖项 ，这些依赖项会被当做形参传到 factory 中，对于依赖的模块会提前执行这被称为：<code>依赖前置</code>。这加大了开发过程中的难度，无论是阅读之前的代码还是编写新的内容，也会出现这样的情况：引入的另一个模块中的内容是条件性执行的。</p> <p>CMD 规范中，只有当我们用到了某个外部模块的时候，它才会去引入，这回答了我们上一小节中遗留的问题，这也是它与 AMD 规范最大的不同点：CMD推崇依赖就近 + 延迟执行</p> <h3 id="es-module-与-amd-模块、cmd模块的差异"><a href="#es-module-与-amd-模块、cmd模块的差异" aria-hidden="true" class="header-anchor">#</a> ES Module 与 AMD 模块、CMD模块的差异</h3> <p>AMD声明一个模块时，必须指定所有的依赖项，CMD 规范的依赖就近的规则定义一个模块，模块的加载逻辑偏重，有时你并不知道当前模块具体依赖了哪些模块或者说这样的依赖关系并不直观。同时，AMD 和 CMD 都只是适用于浏览器端的规范，而 CommonJS 仅仅适用于服务端，都有各自的局限性，而ES Module 是浏览器和服务器通用的模块解决方案。
ES Module 与 CommonJS 一样，语法简介紧凑，支持循环依赖和单个exports导出模块。同时，与 AMD 一样，直接支持异步加载和可配置模块加载。当然，ES Module 的语法比CommonJS更紧凑，结构可以静态分析（用于静态检查，优化等），对循环依赖的支持比 CommonJS 好。
ES6 模块的设计思想是尽量的静态化，使得编译时就能确定模块的依赖关系，以及输入和输出的变量。CommonJS 和 AMD 模块，都只能在运行时确定这些东西。比如，CommonJS 模块就是对象，输入时必须查找对象属性。</p> <h2 id="循环引用"><a href="#循环引用" aria-hidden="true" class="header-anchor">#</a> 循环引用</h2> <h3 id="commonjs-2"><a href="#commonjs-2" aria-hidden="true" class="header-anchor">#</a> CommonJS</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
exports<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token string">'a1'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a.js '</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./b.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a1</span>
exports<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token string">'a2'</span><span class="token punctuation">;</span>
<span class="token comment">// b.js</span>
exports<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token string">'b1'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b.js '</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// b2</span>
exports<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token string">'b2'</span><span class="token punctuation">;</span>
<span class="token comment">// main.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'main.js '</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'main.js '</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./b.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// b2</span>
</code></pre></div><h3 id="es-module-2"><a href="#es-module-2" aria-hidden="true" class="header-anchor">#</a> ES Module</h3> <p>https://blog.csdn.net/keji_123/article/details/78949167</p> <h3 id="amd-模块"><a href="#amd-模块" aria-hidden="true" class="header-anchor">#</a> AMD 模块</h3> <h3 id="cmd模块"><a href="#cmd模块" aria-hidden="true" class="header-anchor">#</a> CMD模块</h3> <h2 id="静态分析"><a href="#静态分析" aria-hidden="true" class="header-anchor">#</a> 静态分析</h2> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>在服务器端，模块的加载是运行时同步加载的；在浏览器端，模块需要提前编译打包处理。
CommonJS 规范加载模块是同步的，也就是说，只有加载完成，才能执行后面的操作。AMD 规范则是非同步加载模块，允许指定回调函数。
由于 Node.js 主要用于服务器编程，模块文件一般都已经存在于本地硬盘，所以加载起来比较快，不用考虑非同步加载的方式，所以 CommonJS 规范比较适用。但是，如果是浏览器环境，要从服务器端加载模块，这时就必须采用非同步模式，因此浏览器端一般采用 AMD 规范。此外 AMD 规范比 CommonJS 规范在浏览器端实现要来着早。
CMD 规范专门用于浏览器端，模块的加载是异步的，模块使用时才会加载执行。CMD 规范整合了 CommonJS 和 AMD 规范的特点。
ES6 模块的设计思想是尽量的静态化，使得编译时就能确定模块的依赖关系，以及输入和输出的变量。CommonJS 和 AMD 模块，都只能在运行时确定这些东西。比如，CommonJS 模块就是对象，输入时必须查找对象属性。</p> <p>CommonJS 规范主要用于服务端编程，加载模块是同步的，这并不适合在浏览器环境，因为同步意味着阻塞加载，浏览器资源是异步加载的，因此有了 AMD CMD 解决方案。</p> <p>AMD 规范在浏览器环境中异步加载模块，而且可以并行加载多个模块。不过，AMD 规范开发成本高，代码的阅读和书写比较困难，模块定义方式的语义不顺畅。</p> <p>CMD 规范与 AMD 规范很相似，都用于浏览器编程，依赖就近，延迟执行，可以很容易在 Node.js 中运行。不过，依赖 SPM 打包，模块的加载逻辑偏重ES6 在语言标准的层面上，实现了模块功能，而且实现得相当简单，完全可以取代 CommonJS 和 AMD 规范，成为浏览器和服务器通用的模块解决方案。
避免命名冲突 (减少命名空间污染)</p> <p>更好的分离, 按需加载
更高复用性
高可维护性</p> <p>AMD规范允许输出的模块兼容CommonJS规范</p></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/iwujingfeng/The-Secret-of-the-Front-End/edit/master/docs/core/module_.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/The-Secret-of-the-Front-End/core/memory-leak.html" class="prev">
          内存泄漏
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/The-Secret-of-the-Front-End/assets/js/28.5c28df11.js" defer></script><script src="/The-Secret-of-the-Front-End/assets/js/app.d61db1a3.js" defer></script>
  </body>
</html>
